(defpoll quote_text :interval "3600s" `fortune -n 90 -s`)
(defpoll TODAY :interval "1s" `date +%m/%d/%y`)
(defpoll distro :interval "12h" "awk '/^ID=/' /etc/*-release | awk -F'=' '{ print tolower($2) }'")
(defpoll de :interval "12h" "echo $XDG_CURRENT_DESKTOP")
(defpoll wm :interval "12h" "wmctrl -m | grep \"Name:\" | awk '{print $2}'")
(defpoll shell :interval "5m" "echo $SHELL | awk -F'/' '{print $NF}'")
(defpoll uptime :interval "30s" "uptime -p | sed -e 's/up //;s/ hours,/h/;s/ minutes/m/'")
(defpoll packages :interval "5m" "pacman -Q | wc -l")
(defpoll NOTES :interval "1s" "cat -s ~/Documents/notes.txt")
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;WIDGETS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defwidget favorites[]
  (box :class "favs" :orientation "v" :space-evenly false :halign "center" :valign "center"
    (button :onclick "pcmanfm ~ &" "")
    (button :onclick "pcmanfm ~/.config/ &" "漣")
    (button :onclick "pcmanfm ~/Downloads &" "")
    (button :onclick "pcmanfm ~/Pictures &" "")
  )
)

(defwidget bg []
  (box :class "bg-box" :orientation "v" :space-evenly false)
)

(defwidget cal []
  (calendar :halign "center" :valign "center" :class "cal" :month 10 :year 2021)
)

(defwidget smalldate []
  (label :class "small-date" :valign "center" :halign "center" :text TODAY)
)

(defwidget uinfo []
  (box :class "uinfo" :orientation "v" :space-evenly false :halign "center" :valign "center"
    (label :style "color: #5e81ac;" :text "sparsh@asus-sea" :halign "center" :valign "center" :wrap "false" :limit-width 25)
    (label :style "color: #efefef;" :text "⎯⎯⎯⎯⎯⎯⎯⎯" :halign "center" :valign "center" :wrap "false" :limit-width 25)
    (box    :orientation "h"
            :space-evenly "false"
            :spacing 10
            (box    :orientation "v"
                    :class "fetch"
                    :spacing 2
                    (label  :style "font-family: 'archcraft'; color: #b48ead;"
                            :halign "end"
                            :text "")
                    (label :style "color: #ebcb8b;"
                           :halign "end"
                           :text "缾")
                    (label  :style "color: #80a0c0;"
                            :halign "end"
                            :text "")
                    (label  :style "color: #b48ead;"
                            :halign "end"
                            :text "")
                    (label  :style "color: #88c0d0;"
                            :halign "end"
                            :text "")
              )
    (box    :orientation "v"
            :class "fetch"
            (label  :style "color: #b48ead;"
                    :halign "start"
                    :text ": ${distro}")
            (label  :style "color: #ebcb8b;"
                    :halign "start"
                    :text ": ${wm}")
            (label  :style "color: #80a0c0;"
                    :halign "start"
                    :text ": ${shell}")
            (label  :style "color: #b48ead;"
                    :halign "start"
                    :text ": ${uptime}")
            (label  :style "color: #88c0d0;"
                    :halign "start"
                    :text ": ${packages}")
          )
      )
    )
  )

(defwidget metric [label value onchange]
  (box :orientation "h"
       :class "metric"
       :space-evenly false
    (box :class "label" label)
    (scale :min 0
           :max 101
           :active {onchange != ""}
           :value value
           :onchange onchange)))

(defwidget cpu[]
  (box :class "cpu" :orientation "v" :space-evenly false :halign "center" :valign "center"
    (metric :label "﬙"
            :value {EWW_CPU.avg}
            :onchange "")
    (metric :label ""
            :value {EWW_RAM.used_mem_perc}
            :onchange "")
    (metric :label "龍"
            :value {(EWW_NET.wlan0.NET_UP)/100}
            :onchange "")
    (metric :label ""
            :value {(EWW_DISK["/"].free / EWW_DISK["/"].total) * 100}
            :onchange "")
  )  
)

(defwidget quote[]
  (box :class "quote" :orientation "v" :space-evenly false :halign "center" :valign "center"
    (label :class "quote-text" :text quote_text :wrap true)
  )
)
(defwidget powermenu[]
  (box :class "powermenu" :orientation "h" :space-evenly false :halign "center"
    (button :class "shutdown" :onrightclick "systemctl poweroff" "")
    (button :class "reboot" :onrightclick "systemctl reboot" "")
    (button :class "lock" :onrightclick "bsplock" "")
    (button :class "suspend" :onrightclick "mpc -q pause & amixer set Master mute & systemctl suspend" "")
    (button :class "logout" :onrightclick "bspc quit" "")
  )
)

(defwidget barCenterWidget []
        (box    :orientation "h"
                :space-evenly false
                :class "bar"
                :spacing "20"
                :halign "center"
                :valign "center"
                (button :onclick "krita&" "")

                (button :onclick "firefox&" "")

                (button :onclick "vscodium&" "﬏")

                (button :onclick "gimp&" "")
    )
)

(defwidget notes []
  (box :spacing 5 :class "notes" :orientation "v" :space-evenly false :halign "center" :valign "center"
    (label :style "color: #5e81ac;" :text NOTES :halign "center" :valign "center" :wrap false :limit-width 50 :vexpand false :hexpand false)
    (box :orientation "h"
      (button :onclick "echo '' > ~/Documents/notes.txt" "[ Empty ]")
      (button :onclick "pcmanfm ~/Documents/notes.txt" "[ Edit TODO ]")
    )
  )
)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;; WINDOWS ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


(defwindow profilewindow
  :wm-ignore: true
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "20px"
                      :y "65px"
                      :width "170px"
                      :height "200px"
                      :anchor "top left")
; :reserve (struts :side "left" :distance "10%")
(uinfo))

(defwindow cpustats
  :class "cpu-win"
  :wm-ignore true
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "200px"
                      :y "275px"
                      :width "170px"
                      :height "50px"
                      :anchor "top left")
(cpu))

(defwindow quotebox
  :wm-ignore true
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "200px"
                      :y "65px"
                      :width "170px"
                      :height "200px"
                      :anchor "top left")
(quote))

(defwindow powermenu
  :wm-ignore true
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "20px"
                      :y "275px"
                      :width "170px"
                      :height "50px"
                      :anchor "top left")
(powermenu))

(defwindow bar
    :monitor 0
    :geometry (geometry     :x "20"
                            :y "335px"
                            :width "170px"
                            :height "70px"
                            :anchor "top left")
    :windowtype "dock"
    :wm-ignore true
(barCenterWidget))

(defwindow calendarWindow
  :wm-ignore: true
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "20px"
                      :y "415px"
                      :width "240px"
                      :height "160px"
                      :anchor "top left")
; :reserve (struts :side "left" :distance "10%")
(cal))

(defwindow favorites
  :wm-ignore: true
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "270px"
                      :y "415px"
                      :width "100px"
                      :height "160px"
                      :anchor "top left")
(favorites))
(defwindow smalldate
  :wm-ignore: true
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "270px"
                      :y "580px"
                      :width "100px"
                      :height "40px"
                      :anchor "top left")
(smalldate))
(defwindow bg
  :class "bg"
  :wm-ignore true
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "5px"
                      :y "40px"
                      :width "380px"
                      :height "720px"
                      :anchor "top left")
(bg))
(defwindow notes
  :class "notepad"
  :wm-ignore: true
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "20px"
                      :y "630px"
                      :width "350px"
                      :height "100px"
                      :anchor "top left")
(notes))
